{"version":3,"sources":["webpack:///webpack/bootstrap edffdefec615e4ca2149","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///./src/app/models/User.js","webpack:///external \"lodash\"","webpack:///./src/app/middlewares/Token.js","webpack:///./src/index.js","webpack:///./src/globals/index.js","webpack:///./src/globals/modules.js","webpack:///external \"shery-logger\"","webpack:///external \"mongoose\"","webpack:///external \"mongoose-timestamp\"","webpack:///external \"async\"","webpack:///external \"validator\"","webpack:///external \"morgan\"","webpack:///external \"body-parser\"","webpack:///external \"path\"","webpack:///external \"bcrypt\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"express\"","webpack:///external \"dotenv\"","webpack:///./src/globals/vars.js","webpack:///./src/config/env.js","webpack:///./src/config/project.js","webpack:///external \"hls-server\"","webpack:///external \"http\"","webpack:///./src/config/database.js","webpack:///./src/app/routes/index.js","webpack:///./src/app/routes/users.js","webpack:///./src/app/middlewares/Auth.js","webpack:///external \"regenerator-runtime\"","webpack:///./src/app/models/sensitive/Hash.js","webpack:///./src/app/controllers/UsersController.js","webpack:///./src/app/middlewares/CORS.js","webpack:///./src/app/middlewares/ExpressPlugins.js","webpack:///./src/app/middlewares/isValid.js"],"names":["userSchema","mongoose","Schema","username","type","String","required","plugin","mongooseTimestamp","virtual","set","password","Hash","update","user","_id","hash","upsert","statics","authorize","Promise","resolve","reject","findOne","savedHash","bcrypt","compare","match","model","config","basedCollection","useridKey","validationConfig","valid","error","userid","docid","validation","jwt","sign","process","env","JWT_SECRET","schema","doc","verify","token","authenticationInfo","User","findById","result","HLSServer","require","http","server","createServer","hls","path","dir","listen","projectMode","console","activeLevel","intro","Name","Project","Description","Notes","Mode","app","express","use","bodyParser","json","CORS","ExpressPlugins","routes","post","req","res","message","static","join","__dirname","next","err","Error","status","validSend","port","API_PORT","info","Number","_","mapKeys","modules","value","name","global","globals","vars","sherylogger","async","validator","logger","dotenv","dotenvPath","argv","forEach","val","index","array","DevProjectInfoKeys","omit","DB_USERNAME","DB_PASSWORD","DB_HOST","DB_PORT","DB_NAME","mongoOptions","useMongoClient","loginInfo","authSource","DB_AUTHSOURCE","uri","connect","db","connection","on","bind","once","log","Router","users","register","login","Auth","me","TOKENKEY","headers","api_token","verified","key","auth","getUpdate","$set","doHash","hashSchema","SchemaTypes","ObjectId","ref","pre","validate","body","email","newUser","save","savedUser","tokenize","registered","JSON","stringify","authenticated","header","validators","isValid","findKeys","object","keys","foundKeys","notFoundKeys","push","objectValue","objectKey","pop","deepOmit","_doc","mapper","Object","o","length","level","map","v","k","okey","newObject","e","requiredKeys","forbiddenKeys","missedKeys","notAllowedKeys","omitKeys","isJSON","defaultOmitKeys","ok"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap edffdefec615e4ca2149","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","/**\n *          .::USER MODEL::.\n * User Mongoose model\n * \n */\nimport Hash from './sensitive/Hash';\n\n\nvar userSchema = mongoose.Schema({\n\n\tusername: {\n\t\ttype: String,\n\t\trequired: true\n\t},\n});\n\nuserSchema.plugin(mongooseTimestamp);\n//UPDATING HASH WHEN PASSWORD IS CHANGED\nuserSchema.virtual('password').set(async function(password){\n\treturn await Hash.update({user:this._id},{user:this._id,hash:password},{upsert:true});\n})\n\n//AUTHORIZE USER\nuserSchema.statics.authorize= function(user){\n\treturn new Promise(async function(resolve,reject){\n\t\ttry{\n\t\t\t//FINDING HASH\n\t\t\tvar savedHash=await Hash.findOne({user:user._id});\n\t\t\tif(!savedHash) return reject(\"hash was not found\");\n\n\t\t\t//COMPARING PASSWORD AND HASH\n\t\t\tvar match=await bcrypt.compare(user.password,savedHash.hash);\n\t\t\tif(match) return resolve(true);\n\t\t\treturn resolve(false);\n\t\t}catch(e){\n\t\t\treturn reject(e);\n\t\t}\n\n\t})\n}\n\n\n\nexport default mongoose.model('User', userSchema);\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/User.js","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 2\n// module chunks = 0","/**\n *          .::TOKENIZATION::.\n * Generating, Verifying and all related operations to Token are here.\n * \n */\nimport User from '../models/User';\n\n//TOKEN CONFIGURATION\n/**\n *  basedCollection: Name of the schema that token is generating from it.\n *  useridKey: Name of the field that userid is stored there in the told collection\n * \n * Example: {\n *      collection: 'Device',\n *      useridKey: 'userid'\n *  } \n * This example generates token based on user's Device.\n */\nlet config = {\n    basedCollection: 'User',\n    useridKey: '_id'\n}\n\nlet validationConfig = () => {\n    if (!config) return {\n        valid: false,\n        error: \"config is not defined\"\n    }\n    if (!config.basedCollection) return {\n        valid: false,\n        error: \"collection name is not defined\"\n    }\n    if (!config.useridKey) return {\n        valid: false,\n        error: \"userid key is not defined\"\n    }\n    return {\n        valid: true\n    }\n\n}\n//GENERATING TOKEN\n/**\n *  @param {string} userid User unique identifier\n *  @param {string} docid Optional- Unique Identifier of basedCollection's document that is related to user. If it's null, this function will find it in database automatically. \n */\nexport default async(userid, docid) => {\n    //CHECKING TOKENIZATION CONFIG\n    var validation = validationConfig();\n    if (!validation.valid) return {\n        error: validation.error\n    };\n    var {\n        basedCollection,\n        useridKey\n    } = config;\n    //IF BASEDCOLLECTION IS USER, USERID AND _ID SHOULD BE SAME.\n    if (basedCollection == 'User') return await jwt.sign({\n        userid,\n        basedCollection,\n        _id: userid\n    },process.env.JWT_SECRET);\n    let schema = mongoose.model(basedCollection);\n    //IF DOCID IS NOT DEFINED, FIND IT IN BASEDCOLLECTION\n    if (!docid) {\n        let doc = await schema.findOne({\n            [useridKey]: userid\n        });\n        if (!doc) return {\n            error: \"No \" + basedCollection + \"'s document with passed \" + useridKey + \" was found.\"\n        }\n        docid=doc._id;\n    }\n    //GENERATING TOKEN\n    return await jwt.sign({\n        userid,\n        basedCollection,\n        docid\n    },process.env.JWT_SECRET);\n\n}\n//VERIFYING TOKEN\nexport let verify=async(token)=>{\n    try{\n        //VERIFYING\n        var authenticationInfo=await jwt.verify(token,process.env.JWT_SECRET);\n        var {basedCollection,userid,docid} =authenticationInfo;\n        //FINDING USER OBJECT\n        var user=await User.findById(userid);\n        var result={user};\n\n        if(basedCollection!='User'){\n        //FINDING BASEDCOLLECTION DOCUMENT\n        var schema=mongoose.model(basedCollection);\n        var doc=await schema.findById(docid);\n        result[basedCollection]=doc;\n        }\n        //RETURNING FOUND OBJECTS\n        return result\n        \n    }catch(e){\n        //INVALID TOKEN\n        return {error:\"Token is not valid.\"}\n    }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/Token.js","/**\n *          .::MAIN FILE::.\n * \n * \n */\nimport vars from \"./globals\";\nimport './config/env';\n\nimport Project from './config/project';\nvar HLSServer = require('hls-server')\nvar http = require('http')\n\n\n\n\nvar server = http.createServer()\nvar hls = new HLSServer(server, {\n  path: '/streams',     // Base URI to output HLS streams\n  dir: 'public/videos'  // Directory that input files are stored\n})\nserver.listen(8000)\n\n\n\n\n\nif (process.env.projectMode == \"Production\") {\n  //Don't print logs in production mode\n  console.config({\n    activeLevel: 2\n  })\n}\n//STARTUP\nconsole.intro({\n  Name: Project.Name,\n  Description: Project.Description,\n  Notes: Project.Notes,\n  Mode: process.env.projectMode\n});\n\nimport './config/database';\nimport routes from './app/routes';\nimport CORS from './app/middlewares/CORS';\nimport ExpressPlugins from './app/middlewares/ExpressPlugins';\n\nconst app = express();\n\n\n// Middlewares\napp.use(bodyParser.json());\napp.use(CORS);\napp.use(ExpressPlugins);\n\n// Routes\nroutes.post('/', (req, res) => res.json({\n  message: Project.Name+ ' API'\n}));\napp.use('/api', routes);\napp.use(express.static(path.join(__dirname, '../public')));\n\napp.use(function (req, res, next) {\n  var err = new Error('Not Found');\n  err.status = 404;\n  next(err);\n});\napp.use((err,req,res,next)=>{\n  if(!err) return res.validSend(201,{});\n  if(!err.status)err.status=500;\n  return res.status(err.status).json({error:err.message})\n})\n\nconst port = process.env.API_PORT || 3000;\n\n\napp.listen(port, (err) => {\n  if (err) {\n    console.error(err)\n  }\n\n  console.info(`listening on port`, Number(port))\n});\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n *          .::GLOBALS::.\n * ALL DATA THAT SHOULD BE AVAILABLE EVERYWHERE\n * \n */\nimport _ from 'lodash';\nimport modules from './modules';\n_.mapKeys(modules, (value, name) => {\n    global[name] = value;\n})\n\nimport vars from './vars';\nglobal.globals = vars;\n\n\n// WEBPACK FOOTER //\n// ./src/globals/index.js","/**\n *          .::GLOBAL MODULES::.\n * Require any module here and it will be available everywhere\n * \n */\nexport default {\n    //Sherytech modules\n    sherylogger:require('shery-logger'),\n    \n    //Data storing modules\n    mongoose: require('mongoose'),\n    mongooseTimestamp:require('mongoose-timestamp'),\n    \n    //Tool modules\n    _: require('lodash'),\n    async: require('async'),\n    validator: require('validator'),\n    logger: require('morgan'),\n    bodyParser: require('body-parser'),\n    path:require('path'),\n\n    //Encryption modules\n    bcrypt:require('bcrypt'),\n    jwt:require('jsonwebtoken'),\n    \n    //Server handling modules\n    express: require('express'),\n\n    //Configuration modules\n    dotenv:require('dotenv'),\n}\n\n\n// WEBPACK FOOTER //\n// ./src/globals/modules.js","module.exports = require(\"shery-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shery-logger\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"mongoose-timestamp\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose-timestamp\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"async\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"async\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"validator\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 19\n// module chunks = 0","/**\n *          .::GLOBAL VARIABLES::. \n * \n */\nexport default {\n    //Add global variables here\n}\n\n\n// WEBPACK FOOTER //\n// ./src/globals/vars.js","/**\n *          .::ENVIRONMENT PARSING::.\n * Parsing .env files and defining Project mode(Development, Production)\n * \n */\nlet dotenvPath = \"../../.dev.env\"\nlet projectMode = \"Development\"\nprocess\n  .argv\n  .forEach((val, index, array) => {\n    switch (val) {\n      case \"--production\":\n        projectMode = \"Production\"\n        return dotenvPath = '../../.env';\n        break;\n\n      //Add more commands here\n      default:\n    }\n  });\n\ndotenv.config({\n  path: path.resolve(__dirname, dotenvPath),\n});\nprocess.env.projectMode=projectMode;\n\n\n// WEBPACK FOOTER //\n// ./src/config/env.js","/**\n *          .::PROJECT CONFIGURATION::.\n * Project configuration and all project's information are defined here.\n * \n */\nlet Project = {\n\n    Name: \"Sherytech Project\",\n    Description: \"Project Description\",\n    Notes: [\"Some Notes to think\", \"List of works to do\", ]\n\n}\nlet DevProjectInfoKeys = [\n    \"Notes\",\n    //Add Key names that shouldn't appear in production mode\n]\nif (process.env.projectMode == \"Production\") {\n    Project = _.omit(Project, DevProjectInfoKeys)\n}\nexport default Project;\n\n\n// WEBPACK FOOTER //\n// ./src/config/project.js","module.exports = require(\"hls-server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"hls-server\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 24\n// module chunks = 0","/**\n *          .::DATABASE CONFIGURATION::.\n * Connecting to Mongo Server and Database Configuration\n * \n */\nmongoose.Promise = global.Promise;\n\nconst {\n\tDB_USERNAME,\n\tDB_PASSWORD,\n\tDB_HOST,\n\tDB_PORT,\n\tDB_NAME\n} = process.env;\n\nconst mongoOptions = {\n\tuseMongoClient: true,\n};\n\n//GENERATING MONGODB URI\nvar loginInfo = \"\";\nvar authSource = \"\";\nif (DB_USERNAME) {\n\tloginInfo = DB_USERNAME + \":\" + DB_PASSWORD + \"@\";\n\tauthSource = \"?authSource=\" + DB_AUTHSOURCE;\n}\nvar uri = \"mongodb://\" + loginInfo + DB_HOST + \":\" + DB_PORT + \"/\" + DB_NAME + authSource;\n\n//CONNECTING TO MONGODB SERVER\nmongoose.connect(uri, mongoOptions);\nconst db = mongoose.connection;\n\n//LOGS\ndb.on('error', console.error.bind(console, 'MongoDB connection error:'));\ndb.once('open', () => console.log('Connected to mongo server.'));\n\n\n// WEBPACK FOOTER //\n// ./src/config/database.js","/**\n *          .::ROUTES::.\n * All routes are imported here.\n * \n */\nconst routes = express.Router();\nimport users from './users';\n\n//USING ROUTES\nroutes.use('/users', users);\n\nexport default routes;\n\n\n// WEBPACK FOOTER //\n// ./src/app/routes/index.js","/**\n *          .::USER ROUTES::.\n * All User's apis are routed here.\n * \n */\nconst routes = express.Router();\n\nimport Auth from '../middlewares/Auth';\nimport {\n\tregister,\n\tlogin,\n\tme\n} from '../controllers/UsersController'\n\n//ENDPOINTS\nroutes.post('/register', register);\nroutes.post('/login', login);\nroutes.post('/me', Auth, me);\n\n\n\nexport default routes;\n\n\n// WEBPACK FOOTER //\n// ./src/app/routes/users.js","/**\n *          .::AUTHENTICATION::.\n * Authentication operations belong here.\n * \n */\nimport User from '../models/User';\nimport {\n\tverify\n} from './Token';\n//The KEY that has token\nconst TOKENKEY=\"x-access-token\"\n\n//API AUTHENTICATION\nexport default async function auth(req, res, next) {\n\t//Getting Token\n\tif (req.headers[TOKENKEY]) var api_token = req.headers[TOKENKEY];\n\t//TOKENNOTFOUND Handling\n\tif (!api_token) return res.validSend(401, \"The following keys are required in request header: \\n \"+TOKENKEY+\"\\n\")\n\t//Verifying token\n\tvar verified = await verify(api_token);\n\t//Verifying token error handling\n\tif (verified.error) return res.validSend(401, verified);\n\t//Adding verified user information to request object.\n\t_.mapKeys(verified, (value, key) => {\n\t\treturn req[key] = value;\n\t});\n\n\tnext();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/Auth.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 29\n// module chunks = 0","/**\n *          .::HASH MODEL::.\n * User's password hashes model\n * \n */\n\nvar hashSchema = mongoose.Schema({\n\n    user: {\n        type: mongoose.SchemaTypes.ObjectId,\n        ref: \"User\"\n    },\n    hash: String,\n});\n\nhashSchema.plugin(mongooseTimestamp)\n\n//HASHING PASSWORD\nasync function doHash(next) {\n    try {\n        var password = this.getUpdate().$set.hash;\n        this.getUpdate().$set.hash = await bcrypt.hash(password, 10);\n        next();\n    } catch (e) {\n        next(e);\n    }\n}\nhashSchema.pre('update', doHash)\nhashSchema.pre('findOneAndUpdate', doHash)\n\n\nexport default mongoose.model('Hash', hashSchema);\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/sensitive/Hash.js","/**\n *          .::USER CONTROLLER::.\n * All related operations to User belong here. \n * \n */\nimport User from '../models/User';\nimport tokenize from '../middlewares/Token'\n\n/*          POST /api/users/register            */\nexport let register = async(req, res, next) => {\n    //REQUEST VALIDATION\n    if (!req.validate([\"username\", \"password\"])) return;\n\n    var {\n        username,\n        password\n    } = req.body;\n    //CHECK IF USER ALREADY EXISTS\n    if(await User.findOne({email})) return res.validSend(409,{error:\"email already exists.\"});\n    //CREATING NEW USER OBJECT\n    var newUser = new User({\n        username,\n        password\n    });\n    try {\n        //SAVING USER\n        var savedUser = await newUser.save();\n        //GENERATING TOKEN\n        var token = await tokenize(savedUser._id);\n\n        //OK RESPONSE\n        res.validSend(200, {\n            registered: true,\n            message: \"User has been registered successfully.\",\n            token: token\n        });\n    } catch (e) {\n        //FAILURE RESPONSE\n        res.validSend(500, {\n            error: JSON.stringify(e)\n        });\n    }\n\n}\n/*          POST /api/users/login            */\nexport let login = async(req, res, next) => {\n    //REQUEST VALIDATION    \n    if (!req.validate([\"username\", \"password\"])) return;\n\n    var {\n        username,\n        password\n    } = req.body;\n    try {\n        //FINDING USER\n        var user = await User.findOne({\n            username\n        });\n        //AUTHENTICATING USER\n        var authenticated = await User.authorize({\n            _id: user._id,\n            password\n        });\n\n        //GENERATING TOKEN\n        if (authenticated)\n            var token = await tokenize(user._id);\n\n        //OK RESPONSE\n        res.validSend(200, {\n            authenticated,\n            token\n        })\n    } catch (e) {\n        //FAILURE RESPONSE\n        res.validSend(500, {\n            error: JSON.stringify(e)\n        })\n    }\n}\n/*          POST /api/users/me            */\nexport let me = async(req, res) => {\n    //OK RESPONSE\n    res.validSend(200, req.User);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/controllers/UsersController.js","/**\n *          .::CORS::.\n * Cross-Origin Resource Sharing configuration\n * \n */\nexport default function CORS(req, res, next) {\n  res.header('Access-Control-Allow-Origin', '*');\n  res.header('Access-Control-Allow-Methods', 'PUT, GET, HEAD, POST, DELETE, OPTIONS');\n  res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, X-Api-Token, Content-Type, Accept, Authorization, Access-Control-Allow-Credentials');\n  res.header('Access-Control-Allow-Credentials', 'true');\n  next();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/CORS.js","/**\n *          .::EXPRESS PLUGINS::.\n * Express plugins and all adding data to req and res are here.\n * \n */\nimport isValid from './isValid';\nexport default (req, res, next)=> {\n\tvalidators(req,res);\n\n\tnext();\n}\n//ADDING REQUEST AND RESPONSE VALIDATORS TO REQUEST\nlet validators=(req,res)=>{\n\tres.validSend=isValid.res;\n\treq.res=res;\n\treq.validate=isValid.req;\n\t\n\t\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/ExpressPlugins.js","/**\n *          .::VALIDATION::.\n * All validation operations belong here.\n *\n */\n\n/**\n * Returns a json object that has `foundKeys` and `notFoundKeys`\n * @param {*} object\n * @param {*[]} keys keys to find in `object`\n */\nlet findKeys = (object, keys) => {\n  var foundKeys = [];\n  var notFoundKeys = [];\n  keys.forEach(key => {\n    notFoundKeys.push(key);\n    _.mapKeys(object, (objectValue, objectKey) => {\n      if (key == objectKey) {\n        if (object[key] && object[key] != null && object[key] != \"\") {\n          foundKeys.push(key);\n          notFoundKeys.pop();\n        }\n      }\n    });\n  });\n  return {\n    foundKeys,\n    notFoundKeys\n  };\n};\nlet deepOmit = (object, keys) => {\n  try {\n    if (object._doc) object = object._doc;\n\n    let mapper = o => {\n      if (Object.keys(o).length > 0) var level = deepOmit(o, keys);\n      else var level = o;\n      return level;\n    };\n    keys.map(okey => {\n      _.mapKeys(object, (v, k) => {\n        if (okey == k) delete object[k];\n      });\n    });\n    var newObject;\n    if (object.length) return object.map(mapper);\n    else {\n      Object.keys(object).map(key => {\n        object[key] = mapper(object[key]);\n      });\n      return object;\n    }\n  } catch (e) {\n    return object;\n  }\n};\n/**\n * request validation\n * @param requiredKeys {string[]} Keys that are required in req.body\n * @param forbiddenKeys {string[]} Keys that are not allowed to be in req.body\n *\n */\nexport function req(requiredKeys, forbiddenKeys) {\n  var req = this;\n  var { res } = req;\n  var { body } = req;\n  if (!requiredKeys) requiredKeys = [];\n  if (!forbiddenKeys) forbiddenKeys = [];\n\n  var missedKeys = findKeys(body, requiredKeys).notFoundKeys;\n  var notAllowedKeys = findKeys(body, forbiddenKeys).foundKeys;\n\n  var error = \"\";\n  if (missedKeys.length > 0)\n    error =\n      \"The following keys are required in request body:\\n \" +\n      _.join(missedKeys, \" , \") +\n      \"\\n\";\n  if (forbiddenKeys.length > 0)\n    error =\n      \"The following keys are forbidden in request body:\\n\" +\n      _.join(forbiddenKeys, \" , \") +\n      \"\\n\";\n\n  if (error == \"\") return true;\n  res.validSend(400, {\n    error\n  });\n  return false;\n}\n/**\n *\n * @param {number} status http status code\n * @param {*} body response body\n * @param {string[]} omitKeys Optional - keys to omit from response body\n */\nexport function res(status, body, omitKeys) {\n  if (!status) status = 200;\n  if (body)\n    if (validator.isJSON(JSON.stringify(body))) {\n      if (body._doc) body = body._doc;\n\n      var defaultOmitKeys = [\"__v\"];\n      if (!omitKeys || omitKeys.length <= 0) omitKeys = defaultOmitKeys;\n      body = deepOmit(body, omitKeys);\n    }\n  if (status == 200) console.ok(\"RESPONSE > \", 200, \" : \", body);\n  else console.error(\"RESPONSE > \", status, \" : \", body);\n  return this.status(status).json(body);\n}\n\nexport default {\n  req,\n  res\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/isValid.js"],"sourceRoot":""}